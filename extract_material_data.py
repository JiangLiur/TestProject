#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
材料等级表数据提取脚本
从68材料等级表.pdf中提取钢管选型信息
"""

import csv
import json

# 手动提取的材料等级表数据
material_data = []

# C1L01级钢管选型 (表B.3)
c1l01_data = [
    {"等级名称": "C1L01", "公称直径DN": 15, "材料": "Q345E", "外径φ": 21, "壁厚mm": 3, "标准号": "GB/T6479 GB/T17395", "压力等级": "Class150", "设计压力": "1.6MPa", "设计温度": "-40℃—100℃"},
    {"等级名称": "C1L01", "公称直径DN": 20, "材料": "Q345E", "外径φ": 27, "壁厚mm": 3, "标准号": "GB/T6479 GB/T17395", "压力等级": "Class150", "设计压力": "1.6MPa", "设计温度": "-40℃—100℃"},
    {"等级名称": "C1L01", "公称直径DN": 25, "材料": "Q345E", "外径φ": 34, "壁厚mm": 4, "标准号": "GB/T6479 GB/T17395", "压力等级": "Class150", "设计压力": "1.6MPa", "设计温度": "-40℃—100℃"},
    {"等级名称": "C1L01", "公称直径DN": 40, "材料": "Q345E", "外径φ": 48, "壁厚mm": 4, "标准号": "GB/T6479 GB/T17395", "压力等级": "Class150", "设计压力": "1.6MPa", "设计温度": "-40℃—100℃"},
    {"等级名称": "C1L01", "公称直径DN": 50, "材料": "Q345E", "外径φ": 60, "壁厚mm": 4, "标准号": "GB/T6479 GB/T17395", "压力等级": "Class150", "设计压力": "1.6MPa", "设计温度": "-40℃—100℃"},
    {"等级名称": "C1L01", "公称直径DN": 65, "材料": "Q345E", "外径φ": 76, "壁厚mm": 5, "标准号": "GB/T6479 GB/T17395", "压力等级": "Class150", "设计压力": "1.6MPa", "设计温度": "-40℃—100℃"},
    {"等级名称": "C1L01", "公称直径DN": 80, "材料": "Q345E", "外径φ": 89, "壁厚mm": 5, "标准号": "GB/T6479 GB/T17395", "压力等级": "Class150", "设计压力": "1.6MPa", "设计温度": "-40℃—100℃"},
    {"等级名称": "C1L01", "公称直径DN": 100, "材料": "Q345E", "外径φ": 114, "壁厚mm": 5, "标准号": "GB/T6479 GB/T17395", "压力等级": "Class150", "设计压力": "1.6MPa", "设计温度": "-40℃—100℃"},
    {"等级名称": "C1L01", "公称直径DN": 150, "材料": "Q345E", "外径φ": 168, "壁厚mm": 6, "标准号": "GB/T6479 GB/T17395", "压力等级": "Class150", "设计压力": "1.6MPa", "设计温度": "-40℃—100℃"},
    {"等级名称": "C1L01", "公称直径DN": 200, "材料": "Q345E", "外径φ": 219, "壁厚mm": 6, "标准号": "GB/T6479 GB/T17395", "压力等级": "Class150", "设计压力": "1.6MPa", "设计温度": "-40℃—100℃"},
    {"等级名称": "C1L01", "公称直径DN": 250, "材料": "Q345E", "外径φ": 273, "壁厚mm": 7, "标准号": "GB/T6479 GB/T17395", "压力等级": "Class150", "设计压力": "1.6MPa", "设计温度": "-40℃—100℃"},
    {"等级名称": "C1L01", "公称直径DN": 300, "材料": "Q345E", "外径φ": 325, "壁厚mm": 8, "标准号": "GB/T6479 GB/T17395", "压力等级": "Class150", "设计压力": "1.6MPa", "设计温度": "-40℃—100℃"},
    {"等级名称": "C1L01", "公称直径DN": 350, "材料": "Q345E", "外径φ": 356, "壁厚mm": 9, "标准号": "GB/T6479 GB/T17395", "压力等级": "Class150", "设计压力": "1.6MPa", "设计温度": "-40℃—100℃"},
    {"等级名称": "C1L01", "公称直径DN": 400, "材料": "Q345E", "外径φ": 406, "壁厚mm": 9, "标准号": "GB/T6479 GB/T17395", "压力等级": "Class150", "设计压力": "1.6MPa", "设计温度": "-40℃—100℃"},
    {"等级名称": "C1L01", "公称直径DN": 450, "材料": "Q345E", "外径φ": 457, "壁厚mm": 9, "标准号": "GB/T6479 GB/T17395", "压力等级": "Class150", "设计压力": "1.6MPa", "设计温度": "-40℃—100℃"},
    {"等级名称": "C1L01", "公称直径DN": 500, "材料": "Q345E", "外径φ": 508, "壁厚mm": 10, "标准号": "GB/T6479 GB/T17395", "压力等级": "Class150", "设计压力": "1.6MPa", "设计温度": "-40℃—100℃"},
    {"等级名称": "C1L01", "公称直径DN": 600, "材料": "Q345E", "外径φ": 610, "壁厚mm": 10, "标准号": "GB/T6479 GB/T17395", "压力等级": "Class150", "设计压力": "1.6MPa", "设计温度": "-40℃—100℃"},
    {"等级名称": "C1L01", "公称直径DN": 700, "材料": "Q345E", "外径φ": 711, "壁厚mm": 12, "标准号": "GB/T6479 GB/T17395", "压力等级": "Class150", "设计压力": "1.6MPa", "设计温度": "-40℃—100℃"},
    {"等级名称": "C1L01", "公称直径DN": 800, "材料": "Q345E", "外径φ": 813, "壁厚mm": 20, "标准号": "GB/T6479 GB/T17395", "压力等级": "Class150", "设计压力": "1.6MPa", "设计温度": "-40℃—100℃"},
]

material_data.extend(c1l01_data)

# C1C01级钢管选型 (表B.57)
c1c01_data = [
    {"等级名称": "C1C01", "公称直径DN": 15, "材料": "L245N", "外径φ": 21.3, "壁厚mm": 3.2, "标准号": "GB/T9711 ISO 4200 PSL2", "压力等级": "Class150", "设计压力": "1.6MPa", "设计温度": "-20℃—100℃"},
    {"等级名称": "C1C01", "公称直径DN": 20, "材料": "L245N", "外径φ": 26.7, "壁厚mm": 3.2, "标准号": "GB/T9711 ISO 4200 PSL2", "压力等级": "Class150", "设计压力": "1.6MPa", "设计温度": "-20℃—100℃"},
    {"等级名称": "C1C01", "公称直径DN": 25, "材料": "L245N", "外径φ": 33.7, "壁厚mm": 4.0, "标准号": "GB/T9711 ISO 4200 PSL2", "压力等级": "Class150", "设计压力": "1.6MPa", "设计温度": "-20℃—100℃"},
    {"等级名称": "C1C01", "公称直径DN": 40, "材料": "L245N", "外径φ": 48.3, "壁厚mm": 4.0, "标准号": "GB/T9711 ISO 4200 PSL2", "压力等级": "Class150", "设计压力": "1.6MPa", "设计温度": "-20℃—100℃"},
    {"等级名称": "C1C01", "公称直径DN": 50, "材料": "L245N", "外径φ": 60.3, "壁厚mm": 4.0, "标准号": "GB/T9711 ISO 4200 PSL2", "压力等级": "Class150", "设计压力": "1.6MPa", "设计温度": "-20℃—100℃"},
    {"等级名称": "C1C01", "公称直径DN": 65, "材料": "L245N", "外径φ": 76.1, "壁厚mm": 4.0, "标准号": "GB/T9711 ISO 4200 PSL2", "压力等级": "Class150", "设计压力": "1.6MPa", "设计温度": "-20℃—100℃"},
    {"等级名称": "C1C01", "公称直径DN": 80, "材料": "L245N", "外径φ": 88.9, "壁厚mm": 4.0, "标准号": "GB/T9711 ISO 4200 PSL2", "压力等级": "Class150", "设计压力": "1.6MPa", "设计温度": "-20℃—100℃"},
    {"等级名称": "C1C01", "公称直径DN": 100, "材料": "L245N", "外径φ": 114.3, "壁厚mm": 5.0, "标准号": "GB/T9711 ISO 4200 PSL2", "压力等级": "Class150", "设计压力": "1.6MPa", "设计温度": "-20℃—100℃"},
    {"等级名称": "C1C01", "公称直径DN": 150, "材料": "L245N", "外径φ": 168.3, "壁厚mm": 5.0, "标准号": "GB/T9711 ISO 4200 PSL2", "压力等级": "Class150", "设计压力": "1.6MPa", "设计温度": "-20℃—100℃"},
    {"等级名称": "C1C01", "公称直径DN": 200, "材料": "L245N", "外径φ": 219.1, "壁厚mm": 5.0, "标准号": "GB/T9711 ISO 4200 PSL2", "压力等级": "Class150", "设计压力": "1.6MPa", "设计温度": "-20℃—100℃"},
    {"等级名称": "C1C01", "公称直径DN": 250, "材料": "L360N", "外径φ": 273, "壁厚mm": 7.1, "标准号": "GB/T9711 ISO 4200 PSL2", "压力等级": "Class150", "设计压力": "1.6MPa", "设计温度": "-20℃—100℃"},
    {"等级名称": "C1C01", "公称直径DN": 300, "材料": "L360N", "外径φ": 323.9, "壁厚mm": 7.1, "标准号": "GB/T9711 ISO 4200 PSL2", "压力等级": "Class150", "设计压力": "1.6MPa", "设计温度": "-20℃—100℃"},
    {"等级名称": "C1C01", "公称直径DN": 350, "材料": "L360N", "外径φ": 355.6, "壁厚mm": 7.1, "标准号": "GB/T9711 ISO 4200 PSL2", "压力等级": "Class150", "设计压力": "1.6MPa", "设计温度": "-20℃—100℃"},
    {"等级名称": "C1C01", "公称直径DN": 400, "材料": "L360N", "外径φ": 406.4, "壁厚mm": 8.0, "标准号": "GB/T9711 ISO 4200 PSL2", "压力等级": "Class150", "设计压力": "1.6MPa", "设计温度": "-20℃—100℃"},
    {"等级名称": "C1C01", "公称直径DN": 450, "材料": "L415M", "外径φ": 457, "壁厚mm": 8.0, "标准号": "GB/T9711 ISO 4200 PSL2", "压力等级": "Class150", "设计压力": "1.6MPa", "设计温度": "-20℃—100℃"},
    {"等级名称": "C1C01", "公称直径DN": 500, "材料": "L415M", "外径φ": 508, "壁厚mm": 8.0, "标准号": "GB/T9711 ISO 4200 PSL2", "压力等级": "Class150", "设计压力": "1.6MPa", "设计温度": "-20℃—100℃"},
    {"等级名称": "C1C01", "公称直径DN": 600, "材料": "L415M", "外径φ": 610, "壁厚mm": 8.8, "标准号": "GB/T9711 ISO 4200 PSL2", "压力等级": "Class150", "设计压力": "1.6MPa", "设计温度": "-20℃—100℃"},
    {"等级名称": "C1C01", "公称直径DN": 700, "材料": "L415M", "外径φ": 711, "壁厚mm": 8.8, "标准号": "GB/T9711 ISO 4200 PSL2", "压力等级": "Class150", "设计压力": "1.6MPa", "设计温度": "-20℃—100℃"},
    {"等级名称": "C1C01", "公称直径DN": 800, "材料": "L415M", "外径φ": 813, "壁厚mm": 10, "标准号": "GB/T9711 ISO 4200 PSL2", "压力等级": "Class150", "设计压力": "1.6MPa", "设计温度": "-20℃—100℃"},
    {"等级名称": "C1C01", "公称直径DN": 900, "材料": "L415M", "外径φ": 914, "壁厚mm": 10, "标准号": "GB/T9711 ISO 4200 PSL2", "压力等级": "Class150", "设计压力": "1.6MPa", "设计温度": "-20℃—100℃"},
    {"等级名称": "C1C01", "公称直径DN": 1000, "材料": "L415M", "外径φ": 1016, "壁厚mm": 11, "标准号": "GB/T9711 ISO 4200 PSL2", "压力等级": "Class150", "设计压力": "1.6MPa", "设计温度": "-20℃—100℃"},
]

material_data.extend(c1c01_data)

# C9C01级钢管选型 (表B.84)
c9c01_data = [
    {"等级名称": "C9C01", "公称直径DN": 15, "材料": "L245N", "外径φ": 21.3, "壁厚mm": 4.5, "标准号": "GB/T9711 ISO 4200 PSL2", "压力等级": "Class900", "设计压力": "13.9MPa", "设计温度": "-20℃—100℃"},
    {"等级名称": "C9C01", "公称直径DN": 20, "材料": "L245N", "外径φ": 26.7, "壁厚mm": 5.0, "标准号": "GB/T9711 ISO 4200 PSL2", "压力等级": "Class900", "设计压力": "13.9MPa", "设计温度": "-20℃—100℃"},
    {"等级名称": "C9C01", "公称直径DN": 25, "材料": "L245N", "外径φ": 33.7, "壁厚mm": 5.4, "标准号": "GB/T9711 ISO 4200 PSL2", "压力等级": "Class900", "设计压力": "13.9MPa", "设计温度": "-20℃—100℃"},
    {"等级名称": "C9C01", "公称直径DN": 40, "材料": "L245N", "外径φ": 48.3, "壁厚mm": 6.3, "标准号": "GB/T9711 ISO 4200 PSL2", "压力等级": "Class900", "设计压力": "13.9MPa", "设计温度": "-20℃—100℃"},
    {"等级名称": "C9C01", "公称直径DN": 50, "材料": "L245N", "外径φ": 60.3, "壁厚mm": 7.1, "标准号": "GB/T9711 ISO 4200 PSL2", "压力等级": "Class900", "设计压力": "13.9MPa", "设计温度": "-20℃—100℃"},
    {"等级名称": "C9C01", "公称直径DN": 65, "材料": "L245N", "外径φ": 76.1, "壁厚mm": 8.0, "标准号": "GB/T9711 ISO 4200 PSL2", "压力等级": "Class900", "设计压力": "13.9MPa", "设计温度": "-20℃—100℃"},
    {"等级名称": "C9C01", "公称直径DN": 80, "材料": "L245N", "外径φ": 88.9, "壁厚mm": 8.8, "标准号": "GB/T9711 ISO 4200 PSL2", "压力等级": "Class900", "设计压力": "13.9MPa", "设计温度": "-20℃—100℃"},
    {"等级名称": "C9C01", "公称直径DN": 100, "材料": "L245N", "外径φ": 114.3, "壁厚mm": 10, "标准号": "GB/T9711 ISO 4200 PSL2", "压力等级": "Class900", "设计压力": "13.9MPa", "设计温度": "-20℃—100℃"},
    {"等级名称": "C9C01", "公称直径DN": 150, "材料": "L245N", "外径φ": 168.3, "壁厚mm": 14.2, "标准号": "GB/T9711 ISO 4200 PSL2", "压力等级": "Class900", "设计压力": "13.9MPa", "设计温度": "-20℃—100℃"},
    {"等级名称": "C9C01", "公称直径DN": 200, "材料": "L245N", "外径φ": 219.1, "壁厚mm": 17.5, "标准号": "GB/T9711 ISO 4200 PSL2", "压力等级": "Class900", "设计压力": "13.9MPa", "设计温度": "-20℃—100℃"},
    {"等级名称": "C9C01", "公称直径DN": 250, "材料": "L360N", "外径φ": 273, "壁厚mm": 20, "标准号": "GB/T9711 ISO 4200 PSL2", "压力等级": "Class900", "设计压力": "13.9MPa", "设计温度": "-20℃—100℃"},
    {"等级名称": "C9C01", "公称直径DN": 300, "材料": "L360N", "外径φ": 323.9, "壁厚mm": 22.2, "标准号": "GB/T9711 ISO 4200 PSL2", "压力等级": "Class900", "设计压力": "13.9MPa", "设计温度": "-20℃—100℃"},
    {"等级名称": "C9C01", "公称直径DN": 350, "材料": "L360N", "外径φ": 355.6, "壁厚mm": 25, "标准号": "GB/T9711 ISO 4200 PSL2", "压力等级": "Class900", "设计压力": "13.9MPa", "设计温度": "-20℃—100℃"},
    {"等级名称": "C9C01", "公称直径DN": 400, "材料": "L360N", "外径φ": 406.4, "壁厚mm": 25, "标准号": "GB/T9711 ISO 4200 PSL2", "压力等级": "Class900", "设计压力": "13.9MPa", "设计温度": "-20℃—100℃"},
    {"等级名称": "C9C01", "公称直径DN": 450, "材料": "L415M", "外径φ": 457, "壁厚mm": 25, "标准号": "GB/T9711 ISO 4200 PSL2", "压力等级": "Class900", "设计压力": "13.9MPa", "设计温度": "-20℃—100℃"},
    {"等级名称": "C9C01", "公称直径DN": 500, "材料": "L415M", "外径φ": 508, "壁厚mm": 28, "标准号": "GB/T9711 ISO 4200 PSL2", "压力等级": "Class900", "设计压力": "13.9MPa", "设计温度": "-20℃—100℃"},
    {"等级名称": "C9C01", "公称直径DN": 600, "材料": "L415M", "外径φ": 610, "壁厚mm": 32, "标准号": "GB/T9711 ISO 4200 PSL2", "压力等级": "Class900", "设计压力": "13.9MPa", "设计温度": "-20℃—100℃"},
    {"等级名称": "C9C01", "公称直径DN": 700, "材料": "L415M", "外径φ": 711, "壁厚mm": 40, "标准号": "GB/T9711 ISO 4200 PSL2", "压力等级": "Class900", "设计压力": "13.9MPa", "设计温度": "-20℃—100℃"},
    {"等级名称": "C9C01", "公称直径DN": 800, "材料": "L415M", "外径φ": 813, "壁厚mm": 45, "标准号": "GB/T9711 ISO 4200 PSL2", "压力等级": "Class900", "设计压力": "13.9MPa", "设计温度": "-20℃—100℃"},
    {"等级名称": "C9C01", "公称直径DN": 900, "材料": "L415M", "外径φ": 914, "壁厚mm": 50, "标准号": "GB/T9711 ISO 4200 PSL2", "压力等级": "Class900", "设计压力": "13.9MPa", "设计温度": "-20℃—100℃"},
    {"等级名称": "C9C01", "公称直径DN": 1000, "材料": "L415M", "外径φ": 1016, "壁厚mm": 55, "标准号": "GB/T9711 ISO 4200 PSL2", "压力等级": "Class900", "设计压力": "13.9MPa", "设计温度": "-20℃—100℃"},
]

material_data.extend(c9c01_data)

# C1S01级钢管选型 (表B.111)
c1s01_data = [
    {"等级名称": "C1S01", "公称直径DN": 15, "材料": "06Cr19Ni10", "外径φ": 21, "壁厚mm": 3, "标准号": "GB/T14976 GB/T17395", "压力等级": "Class150", "设计压力": "1.2MPa", "设计温度": "-45℃—220℃"},
    {"等级名称": "C1S01", "公称直径DN": 20, "材料": "06Cr19Ni10", "外径φ": 27, "壁厚mm": 3, "标准号": "GB/T14976 GB/T17395", "压力等级": "Class150", "设计压力": "1.2MPa", "设计温度": "-45℃—220℃"},
    {"等级名称": "C1S01", "公称直径DN": 25, "材料": "06Cr19Ni10", "外径φ": 34, "壁厚mm": 4, "标准号": "GB/T14976 GB/T17395", "压力等级": "Class150", "设计压力": "1.2MPa", "设计温度": "-45℃—220℃"},
    {"等级名称": "C1S01", "公称直径DN": 40, "材料": "06Cr19Ni10", "外径φ": 48, "壁厚mm": 4, "标准号": "GB/T14976 GB/T17395", "压力等级": "Class150", "设计压力": "1.2MPa", "设计温度": "-45℃—220℃"},
    {"等级名称": "C1S01", "公称直径DN": 50, "材料": "06Cr19Ni10", "外径φ": 60, "壁厚mm": 4, "标准号": "GB/T14976 GB/T17395", "压力等级": "Class150", "设计压力": "1.2MPa", "设计温度": "-45℃—220℃"},
    {"等级名称": "C1S01", "公称直径DN": 65, "材料": "06Cr19Ni10", "外径φ": 76, "壁厚mm": 4, "标准号": "GB/T14976 GB/T17395", "压力等级": "Class150", "设计压力": "1.2MPa", "设计温度": "-45℃—220℃"},
    {"等级名称": "C1S01", "公称直径DN": 80, "材料": "06Cr19Ni10", "外径φ": 89, "壁厚mm": 4, "标准号": "GB/T14976 GB/T17395", "压力等级": "Class150", "设计压力": "1.2MPa", "设计温度": "-45℃—220℃"},
    {"等级名称": "C1S01", "公称直径DN": 100, "材料": "06Cr19Ni10", "外径φ": 114, "壁厚mm": 4.5, "标准号": "GB/T14976 GB/T17395", "压力等级": "Class150", "设计压力": "1.2MPa", "设计温度": "-45℃—220℃"},
    {"等级名称": "C1S01", "公称直径DN": 150, "材料": "06Cr19Ni10", "外径φ": 168, "壁厚mm": 5, "标准号": "GB/T14976 GB/T17395", "压力等级": "Class150", "设计压力": "1.2MPa", "设计温度": "-45℃—220℃"},
    {"等级名称": "C1S01", "公称直径DN": 200, "材料": "06Cr19Ni10", "外径φ": 219, "壁厚mm": 6, "标准号": "GB/T14976 GB/T17395", "压力等级": "Class150", "设计压力": "1.2MPa", "设计温度": "-45℃—220℃"},
]

material_data.extend(c1s01_data)

def save_to_csv(data, filename):
    """保存数据到CSV文件"""
    if not data:
        print("没有数据可保存")
        return

    keys = data[0].keys()
    with open(filename, 'w', newline='', encoding='utf-8-sig') as f:
        writer = csv.DictWriter(f, fieldnames=keys)
        writer.writeheader()
        writer.writerows(data)
    print(f"CSV文件已保存: {filename}")

def save_to_json(data, filename):
    """保存数据到JSON文件"""
    with open(filename, 'w', encoding='utf-8') as f:
        json.dump(data, f, ensure_ascii=False, indent=2)
    print(f"JSON文件已保存: {filename}")

if __name__ == "__main__":
    # 保存为CSV格式
    save_to_csv(material_data, "材料等级表数据.csv")

    # 保存为JSON格式
    save_to_json(material_data, "材料等级表数据.json")

    print(f"\n总共提取了 {len(material_data)} 条数据记录")
    print("\n已提取的等级: C1L01, C1C01, C9C01, C1S01")
    print("\n注意: 这只是部分数据，完整的68个材料等级表需要继续添加")
